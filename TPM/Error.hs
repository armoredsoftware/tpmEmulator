module TPM.Error where
import TPM.Const

errs = [ (tpm_success, "tpm_success")
       , (tpm_authfail, "tpm_authfail")
       , (tpm_badindex, "tpm_badindex")
       , (tpm_bad_parameter, "tpm_bad_parameter")
       , (tpm_auditfailure, "tpm_auditfailure")
       , (tpm_clear_disabled, "tpm_clear_disabled")
       , (tpm_deactivated, "tpm_deactivated")
       , (tpm_disabled, "tpm_disabled")
       , (tpm_disabled_cmd, "tpm_disabled_cmd")
       , (tpm_fail, "tpm_fail")
       , (tpm_bad_ordinal, "tpm_bad_ordinal")
       , (tpm_install_disabled, "tpm_install_disabled")
       , (tpm_invalid_keyhandle, "tpm_invalid_keyhandle")
       , (tpm_keynotfound, "tpm_keynotfound")
       , (tpm_inappropriate_enc, "tpm_inappropriate_enc")
       , (tpm_migratefail, "tpm_migratefail")
       , (tpm_invalid_pcr_info, "tpm_invalid_pcr_info")
       , (tpm_nospace, "tpm_nospace")
       , (tpm_nosrk, "tpm_nosrk")
       , (tpm_notsealed_blob, "tpm_notsealed_blob")
       , (tpm_owner_set, "tpm_owner_set")
       , (tpm_resources, "tpm_resources")
       , (tpm_shortrandom, "tpm_shortrandom")
       , (tpm_size, "tpm_size")
       , (tpm_wrongpcrval, "tpm_wrongpcrval")
       , (tpm_bad_param_size, "tpm_bad_param_size")
       , (tpm_sha_thread, "tpm_sha_thread")
       , (tpm_sha_error, "tpm_sha_error")
       , (tpm_failedselftest, "tpm_failedselftest")
       , (tpm_auth2fail, "tpm_auth2fail")
       , (tpm_badtag, "tpm_badtag")
       , (tpm_ioerror, "tpm_ioerror")
       , (tpm_encrypt_error, "tpm_encrypt_error")
       , (tpm_decrypt_error, "tpm_decrypt_error")
       , (tpm_invalid_authhandle, "tpm_invalid_authhandle")
       , (tpm_no_endorsement, "tpm_no_endorsement")
       , (tpm_invalid_keyusage, "tpm_invalid_keyusage")
       , (tpm_wrong_entitytype, "tpm_wrong_entitytype")
       , (tpm_invalid_postinit, "tpm_invalid_postinit")
       , (tpm_inappropriate_sig, "tpm_inappropriate_sig")
       , (tpm_bad_key_property, "tpm_bad_key_property")
       , (tpm_bad_migration, "tpm_bad_migration")
       , (tpm_bad_scheme, "tpm_bad_scheme")
       , (tpm_bad_datasize, "tpm_bad_datasize")
       , (tpm_bad_mode, "tpm_bad_mode")
       , (tpm_bad_presence, "tpm_bad_presence")
       , (tpm_bad_version, "tpm_bad_version")
       , (tpm_no_wrap_transport, "tpm_no_wrap_transport")
       , (tpm_auditfail_unsuccessful, "tpm_auditfail_unsuccessful")
       , (tpm_auditfail_successful, "tpm_auditfail_successful")
       , (tpm_notresetable, "tpm_notresetable")
       , (tpm_notlocal, "tpm_notlocal")
       , (tpm_bad_type, "tpm_bad_type")
       , (tpm_invalid_resource, "tpm_invalid_resource")
       , (tpm_notfips, "tpm_notfips")
       , (tpm_invalid_family, "tpm_invalid_family")
       , (tpm_no_nv_permission, "tpm_no_nv_permission")
       , (tpm_requires_sign, "tpm_requires_sign")
       , (tpm_key_notsupported, "tpm_key_notsupported")
       , (tpm_auth_conflict, "tpm_auth_conflict")
       , (tpm_area_locked, "tpm_area_locked")
       , (tpm_bad_locality, "tpm_bad_locality")
       , (tpm_read_only, "tpm_read_only")
       , (tpm_per_nowrite, "tpm_per_nowrite")
       , (tpm_familycount, "tpm_familycount")
       , (tpm_write_locked, "tpm_write_locked")
       , (tpm_bad_attributes, "tpm_bad_attributes")
       , (tpm_invalid_structure, "tpm_invalid_structure")
       , (tpm_key_owner_control, "tpm_key_owner_control")
       , (tpm_bad_counter, "tpm_bad_counter")
       , (tpm_not_fullwrite, "tpm_not_fullwrite")
       , (tpm_context_gap, "tpm_context_gap")
       , (tpm_maxnvwrites, "tpm_maxnvwrites")
       , (tpm_nooperator, "tpm_nooperator")
       , (tpm_resourcemissing, "tpm_resourcemissing")
       , (tpm_delegate_lock, "tpm_delegate_lock")
       , (tpm_delegate_family, "tpm_delegate_family")
       , (tpm_delegate_admin, "tpm_delegate_admin")
       , (tpm_transport_notexclusive, "tpm_transport_notexclusive")
       , (tpm_owner_control, "tpm_owner_control")
       , (tpm_daa_resources, "tpm_daa_resources")
       , (tpm_daa_input_data0, "tpm_daa_input_data0")
       , (tpm_daa_input_data1, "tpm_daa_input_data1")
       , (tpm_daa_issuer_settings, "tpm_daa_issuer_settings")
       , (tpm_daa_tpm_settings, "tpm_daa_tpm_settings")
       , (tpm_daa_stage, "tpm_daa_stage")
       , (tpm_daa_issuer_validity, "tpm_daa_issuer_validity")
       , (tpm_daa_wrong_w, "tpm_daa_wrong_w")
       , (tpm_bad_handle, "tpm_bad_handle")
       , (tpm_bad_delegate, "tpm_bad_delegate")
       , (tpm_badcontext, "tpm_badcontext")
       , (tpm_toomanycontexts, "tpm_toomanycontexts")
       , (tpm_ma_ticket_signature, "tpm_ma_ticket_signature")
       , (tpm_ma_destination, "tpm_ma_destination")
       , (tpm_ma_source, "tpm_ma_source")
       , (tpm_ma_authority, "tpm_ma_authority")
       , (tpm_permanentek, "tpm_permanentek")
       , (tpm_bad_signature, "tpm_bad_signature")
       , (tpm_nocontextspace, "tpm_nocontextspace")
       , (tpm_retry, "tpm_retry")
       , (tpm_needs_selftest, "tpm_needs_selftest")
       , (tpm_doing_selftest, "tpm_doing_selftest")
       , (tpm_defend_lock_running, "tpm_defend_lock_running")
       ]

mkerr err = case lookup err errs of
    Just e -> e
    Nothing -> "unknown error"
